# 프록시 서버의 개념
프록시 서버(proxy server)는 클라이언트가 자신을 통해서 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해 주는 컴퓨터 시스템이나 응용 프로그램을 가리킨다.
서버와 클라이언트 사이에 중계기로서 대리로 통신을 수행하는 것을 가리켜 ‘프록시’, 그 중계 기능을 하는 것을 프록시 서버라고 부른다.

## 포워드 프록시
![image](https://user-images.githubusercontent.com/82895809/195990787-67e32df6-15d3-45d3-9f01-e162cd20695c.png)

일반적으로 프록시라고 말하면 포워드 프록시를 말한다.

클라이언트에서 서버로 리소스를 요청할 때 직접 요청하지 않고 프록시 서버를 거쳐서 요청한다. 이 경우 서버에서 받는 IP는 클라이언트의 IP가 아닌 프록시 서브의 IP이기 때문에 서버는 클라이언트가 누군지 알 수 없다. 즉, 서버에게 클라이언트가 누구인지 감춰주는 역할을 한다.

이러한 특징 때문에 기업 사내망에서 주로 사용된다.

## 리버스 프록시
![image](https://user-images.githubusercontent.com/82895809/195990888-560a2e88-4a82-4c3e-8613-3b4de033519c.png)

리버스 프록시는 포워드 프록시와 반대 개념이다. 애플리케이션 서버의 앞에 위치하여 클라이언트가 서버를 요청할 때 리버스 프록시를 호출하고, 리버스 프록시가 서버로부터 응답을 전달받아 다시 클라이언트에게 전송하는 역할을 한다.

이 경우, 클라이언트는 애플리케이션 서버를 직접 호출하는 것이 아니라 프록시 서버를 통해 호출하기 때문에 리버스 프록시는 애플리케이션 서버를 감추는 역할을 하게 된다.

* 리버스 프록시의 예시 - NginX, Apache Web Server

```bash
dnf -y install squid
```
vi 에디터로 /etc/squid/squid.conf 파일을 수정.

acl centos8 src 192.168.111.0/255.255.255.0
http_access allow centos8
cache_dir ufs /var/spool/squid 1000 16 256
visible_hostname centos8

acl은 Access Control List의 약자로, 모든 컴퓨터가 아닌 지정된 컴퓨터나 네트워크만 프록시 서버에 접근할 수 있도록 제한하는 구문이다.

이 예에서는 192.168.111.0 네트워크의 컴퓨터를 centos8이라는 이름으로 지정했다.

http_access는 allow와 deny를 설정할 수 있는데, 여기서 centos8 이름으로 설정된 네트워크의 접근을 허용하는 cache_dir은 캐시할 디스크를 지정한다.

ufs는 일반적으로 사용되는 스퀴드용 파일시스템으로 지정하며 /var/spool/squid는 캐시 디렉터리를 적어준다.

1000은 캐시할 데이터 공간을 MB 단위로 지정한다.

16은 캐시에서 사용할 하부 디렉터리 개수, 256은 앞의 16개 디렉터리 안에 다시 생성할 디렉터리 개수를 지정한다.

cache_dir에 지정된 값들은 서버 및 네트워크 상황에 맞게 변경해서 사용하면 된다.

visible_hostname은 네트워크의 이름을 외부에 보이도록 설정하는 것인데 별로 중요하지 않다.

또 62행쯤에 Squid는 기본적으로 3128번 포트를 사용하는 것으로 되어 있다.

```bash
firewall-cmd --permanent --add-port=3128/tcp
firewall-cmd --reload
```
포트 3128번 허용.

![image](https://user-images.githubusercontent.com/82895809/195992330-b753d55c-a9e7-4d45-a686-54794dda921e.png)

```bash
systemctl restart squid
systemctl enable squid
systemctl status squid
```
squid 서비스 가동.


