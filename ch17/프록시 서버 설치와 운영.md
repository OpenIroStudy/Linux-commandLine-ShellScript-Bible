# 프록시 서버의 개념
프록시 서버(proxy server)는 클라이언트가 자신을 통해서 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해 주는 컴퓨터 시스템이나 응용 프로그램을 가리킨다.

서버와 클라이언트 사이에 중계기로서 대리로 통신을 수행하는 것을 가리켜 ‘프록시’, 그 중계 기능을 하는 것을 프록시 서버라고 부른다.

프록시 서버 중 일부는 프록시 서버에 요청된 내용들을 캐시를 이용하여 저장해 둔다. 

이렇게 캐시를 해 두고 난 후에, 캐시 안에 있는 정보를 요구하는 요청에 대해서는 원격 서버에 접속하여 데이터를 가져올 필요가 없게 됨으로써 전송 시간을 절약할 수 있게 됨과 동시에 불필요하게 외부와의 연결을 하지 않아도 된다는 장점을 갖게 된다. 

또한 외부와의 트래픽을 줄이게 됨으로써 네트워크 병목 현상을 방지하는 효과도 얻을 수 있게 된다.

## 포워드 프록시
![image](https://user-images.githubusercontent.com/82895809/195990787-67e32df6-15d3-45d3-9f01-e162cd20695c.png)

일반적으로 프록시라고 말하면 포워드 프록시를 말한다.

클라이언트에서 서버로 리소스를 요청할 때 직접 요청하지 않고 프록시 서버를 거쳐서 요청한다. 

이 경우 서버에서 받는 IP는 클라이언트의 IP가 아닌 프록시 서브의 IP이기 때문에 서버는 클라이언트가 누군지 알 수 없다. 

즉, 서버에게 클라이언트가 누구인지 감춰주는 역할을 한다.

이러한 특징 때문에 기업 사내망에서 주로 사용된다.

## 리버스 프록시
![image](https://user-images.githubusercontent.com/82895809/195990888-560a2e88-4a82-4c3e-8613-3b4de033519c.png)

리버스 프록시는 포워드 프록시와 반대 개념이다. 

애플리케이션 서버의 앞에 위치하여 클라이언트가 서버를 요청할 때 리버스 프록시를 호출하고, 리버스 프록시가 서버로부터 응답을 전달받아 다시 클라이언트에게 전송하는 역할을 한다.

이 경우, 클라이언트는 애플리케이션 서버를 직접 호출하는 것이 아니라 프록시 서버를 통해 호출하기 때문에 리버스 프록시는 애플리케이션 서버를 감추는 역할을 하게 된다.

* 리버스 프록시의 예시 - NginX, Apache Web Server

## Squid
스퀴드(squid)는 대중적인 오픈 소스(GPL)소프트웨어 프록시 서버이자 웹 캐시이다. 

반복된 요청을 캐싱함으로 웹서버의 속도를 향상시키는 것부터, 네트워크 자원을 공유하려는 사람들에게 웹, DNS와 다른 네트워크 검색의 캐싱을 제공하고, 트래픽을 걸러줌으로써 안정성에 도움을 주는 등에 이르기까지 광범위 하게 이용된다.

스퀴드는 기본적으로 유닉스 계열 시스템에서 돌아가도록 설계되었다.

스퀴드는 매우 오랜 기간 동안 개발되었기에 완성된 형태이며 튼튼하다. 기본적으로 HTTP와 FTP에 사용되지만 TLS, SSL, HTTPS 등과 같이 많은 프로토콜을 지원한다.

```bash
dnf -y install squid
```
vi 에디터로 /etc/squid/squid.conf 파일을 수정.

```bash
acl centos8 src 192.168.111.0/255.255.255.0
http_access allow centos8
cache_dir ufs /var/spool/squid 1000 16 256
visible_hostname centos8
```

acl은 Access Control List의 약자로, 모든 컴퓨터가 아닌 지정된 컴퓨터나 네트워크만 프록시 서버에 접근할 수 있도록 제한하는 구문이다.

이 예에서는 192.168.111.0 네트워크의 컴퓨터를 centos8이라는 이름으로 지정했다.

http_access는 allow와 deny를 설정할 수 있는데, 여기서 centos8 이름으로 설정된 네트워크의 접근을 허용하는 cache_dir은 캐시할 디스크를 지정한다.

ufs는 일반적으로 사용되는 스퀴드용 파일시스템으로 지정하며 /var/spool/squid는 캐시 디렉터리를 적어준다.

1000은 캐시할 데이터 공간을 MB 단위로 지정한다.

16은 캐시에서 사용할 하부 디렉터리 개수, 256은 앞의 16개 디렉터리 안에 다시 생성할 디렉터리 개수를 지정한다.

cache_dir에 지정된 값들은 서버 및 네트워크 상황에 맞게 변경해서 사용하면 된다.

visible_hostname은 네트워크의 이름을 외부에 보이도록 설정하는 것인데 별로 중요하지 않다.

또 62행쯤에 Squid는 기본적으로 3128번 포트를 사용하는 것으로 되어 있다.

```bash
firewall-cmd --permanent --add-port=3128/tcp
firewall-cmd --reload
```
포트 3128번 허용.

![image](https://user-images.githubusercontent.com/82895809/195992330-b753d55c-a9e7-4d45-a686-54794dda921e.png)

```bash
systemctl restart squid
systemctl enable squid
systemctl status squid
```
squid 서비스 가동.

![image](https://user-images.githubusercontent.com/82895809/195993818-3f057b12-b6b0-445d-8d6c-7290a7347974.png)

그러면 이제 정상적으로 웹 서핑이 되야하는데 난 안됨.

![image](https://user-images.githubusercontent.com/82895809/195993392-4d81a369-69a0-4256-98f1-a9dfd3f3598b.png)

윈도우 10도 해보려하는데 이상해서 진행못함.
